models:
  Sparse_Unet_Fragment:
    class: sparseconv3d.APIModel
    conv_type: "SPARSE"
    backend: "torchsparse"
    loss_mode: "match"
    define_constants:
      in_feat: 32
      block: ResBlock # Can be any of the blocks in modules/MinkowskiEngine/api_modules.py
    backbone:
      down_conv:
        module_name: ResNetDown
        block: block
        down_conv_nn:
          [
            [FEAT, in_feat],
            [in_feat, 2* in_feat],
            [2* in_feat, 2 * in_feat],
            [2 * in_feat, 4 * in_feat],
          ]
        kernel_size: [5, 3, 3, 3]
        stride: [1, 2, 2, 2]
      up_conv:
        block: block
        module_name: ResNetUp
        up_conv_nn:
          [
            [4*in_feat, 2*in_feat],
            [2*in_feat + 2*in_feat, 2*in_feat],
            [2*in_feat + 2*in_feat, 2*in_feat],
            [2*in_feat + in_feat, 2*in_feat],
          ]
        kernel_size: 3
        stride: [2, 2, 2, 1]
    mlp_cls:
      nn: [2*in_feat, in_feat]
    normalize_feature: True
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4
