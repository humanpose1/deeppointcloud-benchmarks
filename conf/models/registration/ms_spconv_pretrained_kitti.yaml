models:
  ms_sparseconv3d_shared_pretrained_3_network:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/supervised/ms_spconv_shared_with_int_loss/ms_sparseconv3d_shared_pretrained_with_int_loss.pt"
    weight_name: "latest"
    conv_type: "SPARSE"
    loss_mode: "match"
    define_constants:
      num_scales: 3
      out_feat: 32
    backend: "torchsparse"
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 64],
              [64, 128]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [128, 64],
              [64 + 64, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, 2 * out_feat, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4

  ms_sparseconv3d_shared_pretrained_3_network_1:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/supervised/ms_spconv_shared_1/ms_sparseconv3d_shared_pretrained.pt"
    weight_name: "latest"
    conv_type: "SPARSE"
    loss_mode: "match"
    define_constants:
      num_scales: 3
      out_feat: 32
    backend: "torchsparse"
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 64],
              [64, 128]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [128, 64],
              [64 + 64, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, 2 * out_feat, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4

  ms_sparseconv3d_shared_pretrained_3_network_eth:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/2020-11-15/11-11-09/ms_sparseconv3d_shared_pretrained_3_network.pt"
    weight_name: "latest"
    conv_type: "SPARSE"
    loss_mode: "match"
    define_constants:
      num_scales: 3
      out_feat: 32
    backend: "torchsparse"
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 64],
              [64, 128]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [128, 64],
              [64 + 64, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, 2 * out_feat, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4

  ms_sparseconv3d_shared_pretrained_3_network_with_int_loss:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/supervised/ms_spconv_shared_with_int_loss/ms_sparseconv3d_shared_pretrained_with_int_loss.pt"
    weight_name: "latest"
    conv_type: "SPARSE"
    loss_mode: "match"
    define_constants:
      num_scales: 3
      out_feat: 32
    backend: "torchsparse"
    intermediate_loss:
      metric_loss:
        class: "ContrastiveHardestNegativeLoss"
        params:
          num_pos: 64
          num_hn_samples: 32
          pos_thresh: 0.1
          neg_thresh: 1.4
      weights: [0.1, 0.1, 0.1]
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 64],
              [64, 128]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [128, 64],
              [64 + 64, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, 2 * out_feat, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4

  ms_sparseconv3d_shared_pretrained_5_network:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/supervised/ms_spconv_shared/ms_sparseconv3d_shared.pt"
    weight_name: "latest"
    conv_type: "SPARSE"
    loss_mode: "match"
    define_constants:
      num_scales: 5
      out_feat: 32
    backend: "torchsparse"
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3, 0.4, 0.5]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 64],
              [64, 128]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [128, 64],
              [64 + 64, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, out_feat, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4

  ms_sparseconv3d_shared_pretrained_5_network_1:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/supervised/ms_spconv_shared/ms_sparseconv3d_shared.pt"
    weight_name: "latest"
    conv_type: "SPARSE"
    loss_mode: "match"
    define_constants:
      num_scales: 5
      out_feat: 32
    backend: "torchsparse"
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3, 0.4, 0.5]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 64],
              [64, 128]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [128, 64],
              [64 + 64, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, out_feat*2, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4


  ms_sparseconv3d_shared_pretrained_3_network_large:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    conv_type: "SPARSE"
    loss_mode: "match"
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/supervised/ms_spconv_shared_with_int_loss_large/ms_sparseconv3d_shared_pretrained_with_int_loss_large.pt"
    weight_name: "latest"
    define_constants:
      num_scales: 3
      out_feat: 32
    backend: "torchsparse"
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 128],
              [128, 256]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [256, 64],
              [64 + 128, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, 2 * out_feat, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4

  ms_sparseconv3d_shared_pretrained_3_network_large_eth:
    class: ms_spconv3d.MS_SparseConv3d_Shared
    conv_type: "SPARSE"
    loss_mode: "match"
    path_pretrained: "/media/admincaor/DataHDD2To/mines/code/deeppointcloud-benchmarks/outputs/2020-12-01/22-48-12/ms_sparseconv3d_shared_pretrained_3_network_large.pt"
    weight_name: "latest"
    define_constants:
      num_scales: 3
      out_feat: 32
    backend: "torchsparse"
    option_unet:
      input_nc: 1
      num_scales: num_scales
      grid_size: [0.1, 0.2, 0.3]
      post_mlp_nn: [64, 32]
      backbone:
        down_conv:
          module_name: ResNetDown
          dimension: 3
          down_conv_nn:
            [
              [FEAT, 32],
              [32, 64],
              [64, 128],
              [128, 256]
            ]
          kernel_size: [5, 3, 3, 3]
          stride: [1, 2, 2, 2]
          dilation: [1, 1, 1, 1]
        up_conv:
          module_name: ResNetUp
          dimension: 3
          bn_momentum: 0.05
          up_conv_nn:
            [
              [256, 64],
              [64 + 128, 64],
              [64 + 64, 64],
              [64 + 32, 64]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
          dilation: [1, 1, 1, 1]
    normalize_feature: True
    mlp_cls:
      nn: [num_scales*out_feat, 2 * out_feat, out_feat]
      bn_momentum: 0.05
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4
