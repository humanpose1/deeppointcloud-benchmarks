models:
  EMHS_0:
    class: emhs.EquiMHS
    conv_type: "PARTIAL_DENSE"
    loss_mode: "match"
    define_constants:
      in_feat: 32
      out_feat: 32
      block: ResBlock
    unet:
      model_type: "Minkowski"
      is_center: True
      add_pos: True
      voxel_size: 0.1
      nn_pre: [FEAT + 3, 8, 16, 16, in_feat]
      nn_post: [out_feat + 3, 64, in_feat]
      config:
        down_conv:
          block: block
          module_name: ResNetDown
          N: [0, 1, 1, 1]
          down_conv_nn:
            [
              [in_feat, in_feat],
              [in_feat, 2 * in_feat],
              [2 * in_feat, 4 * in_feat],
              [4 * in_feat, 8 * in_feat]
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [1, 2, 2, 2]
        up_conv:
          block: block
          module_name: ResNetUp
          N: [1, 1, 1, 0]
          up_conv_nn:
            [
              [8*in_feat, 2*in_feat],
              [2*in_feat + 4*in_feat, 2*in_feat],
              [2*in_feat + 2*in_feat, 2*in_feat],
              [2*in_feat + 1*in_feat, out_feat],
            ]
          kernel_size: [3, 3, 3, 3]
          stride: [2, 2, 2, 1]
    normalize_feature: True
    metric_loss:
      class: "ContrastiveHardestNegativeLoss"
      params:
        num_pos: 1024
        num_hn_samples: 256
        pos_thresh: 0.1
        neg_thresh: 1.4
